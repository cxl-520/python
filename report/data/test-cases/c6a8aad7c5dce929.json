{"uid":"c6a8aad7c5dce929","name":"Verify code","fullName":"testcase.test_api.test_phone.TestPhone#test_verify_code","historyId":"ccf9b20934c0c3b82f3790d1e5a56565","time":{"start":1770796346332,"stop":1770796346426,"duration":94},"status":"failed","statusMessage":"Failed: verify failed, business code: 1103","statusTrace":"self = <testcase.test_api.test_phone.TestPhone object at 0x000002754EB40EE0>\n\n    @allure.title(\"Verify code\")\n    @allure.severity(allure.severity_level.CRITICAL)\n    @pytest.mark.run(order=2)\n    def test_verify_code(self):\n        with allure.step(\"Step 1: read code input\"):\n            if sys.stdin is not sys.__stdin__:\n                sys.stdin = sys.__stdin__\n            # code = input(\"Enter received code: \")\n            code=\"187234\"\n            allure.attach(f\"code: {code}\", name=\"code\", attachment_type=allure.attachment_type.TEXT)\n    \n        with allure.step(\"Step 2: build request params\"):\n            params_data = {\"phone\": self.phone, \"code\": code}\n            allure.attach(json.dumps(params_data), name=\"params\", attachment_type=allure.attachment_type.JSON)\n    \n        with allure.step(\"Step 3: call verify API\"):\n            try:\n                res = requests.post(self.check_url, data=params_data, timeout=10)\n                allure.attach(str(res.status_code), name=\"status\", attachment_type=allure.attachment_type.TEXT)\n                allure.attach(res.text, name=\"body\", attachment_type=allure.attachment_type.JSON)\n    \n                if res.status_code != 200:\n                    pytest.skip(f\"Non-200 status code: {res.status_code}\")\n    \n                res_json = res.json()\n                if isinstance(res_json, dict) and \"code\" not in res_json and \"status\" in res_json:\n                    res_json[\"code\"] = res_json.get(\"status\")\n    \n                code_val = res_json.get(\"code\") if isinstance(res_json, dict) else None\n                if code_val not in (0, 200, None):\n>                   pytest.fail(f\"verify failed, business code: {code_val}\")\nE                   Failed: verify failed, business code: 1103\n\ntestcase\\test_api\\test_phone.py:99: Failed","flaky":false,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[{"name":"_xunit_setup_class_fixture_TestPhone","time":{"start":1770796346331,"stop":1770796346332,"duration":1},"status":"passed","steps":[{"name":"Step 0: read and validate phone number","time":{"start":1770796346331,"stop":1770796346332,"duration":1},"status":"passed","steps":[],"attachments":[{"uid":"40501a2554fc580b","name":"phone","source":"40501a2554fc580b.txt","type":"text/plain","size":18}],"parameters":[],"hasContent":true,"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":1,"attachmentStep":false}],"attachments":[],"parameters":[],"hasContent":true,"stepsCount":1,"shouldDisplayMessage":false,"attachmentsCount":1,"attachmentStep":false}],"testStage":{"status":"failed","statusMessage":"Failed: verify failed, business code: 1103","statusTrace":"self = <testcase.test_api.test_phone.TestPhone object at 0x000002754EB40EE0>\n\n    @allure.title(\"Verify code\")\n    @allure.severity(allure.severity_level.CRITICAL)\n    @pytest.mark.run(order=2)\n    def test_verify_code(self):\n        with allure.step(\"Step 1: read code input\"):\n            if sys.stdin is not sys.__stdin__:\n                sys.stdin = sys.__stdin__\n            # code = input(\"Enter received code: \")\n            code=\"187234\"\n            allure.attach(f\"code: {code}\", name=\"code\", attachment_type=allure.attachment_type.TEXT)\n    \n        with allure.step(\"Step 2: build request params\"):\n            params_data = {\"phone\": self.phone, \"code\": code}\n            allure.attach(json.dumps(params_data), name=\"params\", attachment_type=allure.attachment_type.JSON)\n    \n        with allure.step(\"Step 3: call verify API\"):\n            try:\n                res = requests.post(self.check_url, data=params_data, timeout=10)\n                allure.attach(str(res.status_code), name=\"status\", attachment_type=allure.attachment_type.TEXT)\n                allure.attach(res.text, name=\"body\", attachment_type=allure.attachment_type.JSON)\n    \n                if res.status_code != 200:\n                    pytest.skip(f\"Non-200 status code: {res.status_code}\")\n    \n                res_json = res.json()\n                if isinstance(res_json, dict) and \"code\" not in res_json and \"status\" in res_json:\n                    res_json[\"code\"] = res_json.get(\"status\")\n    \n                code_val = res_json.get(\"code\") if isinstance(res_json, dict) else None\n                if code_val not in (0, 200, None):\n>                   pytest.fail(f\"verify failed, business code: {code_val}\")\nE                   Failed: verify failed, business code: 1103\n\ntestcase\\test_api\\test_phone.py:99: Failed","steps":[{"name":"Step 1: read code input","time":{"start":1770796346332,"stop":1770796346333,"duration":1},"status":"passed","steps":[],"attachments":[{"uid":"80fee108a8137bfe","name":"code","source":"80fee108a8137bfe.txt","type":"text/plain","size":12}],"parameters":[],"hasContent":true,"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":1,"attachmentStep":false},{"name":"Step 2: build request params","time":{"start":1770796346333,"stop":1770796346333,"duration":0},"status":"passed","steps":[],"attachments":[{"uid":"7dc008a15e866b67","name":"params","source":"7dc008a15e866b67.json","type":"application/json","size":42}],"parameters":[],"hasContent":true,"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":1,"attachmentStep":false},{"name":"Step 3: call verify API","time":{"start":1770796346333,"stop":1770796346425,"duration":92},"status":"failed","statusMessage":"Failed: verify failed, business code: 1103\n","statusTrace":"  File \"C:\\Users\\Administrator\\PycharmProjects\\PythonProject\\testcase\\test_api\\test_phone.py\", line 99, in test_verify_code\n    pytest.fail(f\"verify failed, business code: {code_val}\")\n  File \"C:\\Users\\Administrator\\PycharmProjects\\PythonProject\\.venv\\lib\\site-packages\\_pytest\\outcomes.py\", line 177, in fail\n    raise Failed(msg=reason, pytrace=pytrace)\n","steps":[],"attachments":[{"uid":"482788c3129cb11a","name":"status","source":"482788c3129cb11a.txt","type":"text/plain","size":3},{"uid":"72efb312b5385ddf","name":"body","source":"72efb312b5385ddf.json","type":"application/json","size":78}],"parameters":[],"hasContent":true,"stepsCount":0,"shouldDisplayMessage":true,"attachmentsCount":2,"attachmentStep":false}],"attachments":[],"parameters":[],"hasContent":true,"stepsCount":3,"shouldDisplayMessage":true,"attachmentsCount":4,"attachmentStep":false},"afterStages":[{"name":"_xunit_setup_class_fixture_TestPhone::0","time":{"start":1770796346434,"stop":1770796346434,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"hasContent":false,"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"attachmentStep":false}],"labels":[{"name":"story","value":"Send and verify flow"},{"name":"feature","value":"Phone code"},{"name":"epic","value":"SMS verification"},{"name":"severity","value":"critical"},{"name":"parentSuite","value":"testcase.test_api"},{"name":"suite","value":"test_phone"},{"name":"subSuite","value":"TestPhone"},{"name":"host","value":"PC-20250907ITIM"},{"name":"thread","value":"12092-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"testcase.test_api.test_phone"},{"name":"resultFormat","value":"allure2"}],"parameters":[],"links":[],"hidden":false,"retry":false,"extra":{"severity":"critical","retries":[],"categories":[{"name":"Product defects","matchedStatuses":[]}],"history":{"statistic":{"failed":2,"broken":0,"skipped":1,"passed":0,"unknown":0,"total":3},"items":[{"uid":"e488129fb096754c","status":"failed","statusDetails":"Failed: verify failed, business code: 1103","time":{"start":1770794271626,"stop":1770794271725,"duration":99}},{"uid":"d0d52f6e12be1b5d","status":"skipped","statusDetails":"Skipped: Non-200 status code: 502","time":{"start":1770793901941,"stop":1770793902004,"duration":63}}]},"tags":[]},"source":"c6a8aad7c5dce929.json","parameterValues":[]}